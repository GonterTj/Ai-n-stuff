"use strict";exports.id=488,exports.ids=[488],exports.modules={71488:(e,n,t)=>{t.r(n),t.d(n,{BE_PROFILE:()=>y,NRT_PROFILE:()=>p,PostChannel:()=>ue,RT_PROFILE:()=>h});var i=t(27421),r=t(29141),a=t(81782),o=t(47954),s=t(87624),u=t(65705),c=t(24869),l=t(49251),f=t(28452),d=t(29339),v=t(87951),h="REAL_TIME",p="NEAR_REAL_TIME",y="BEST_EFFORT",m="",g="POST",b="drop",S="send",T="requeue",_="rspFail",x="application/x-json-stream",R="cache-control",E="content-type",k="kill-duration",w="time-delta-millis",K="client-version",O="client-id",P="time-delta-to-apply-millis",C="upload-time",M="apikey",A="AuthMsaDeviceTicket",B="AuthXToken";function H(e){var n=(e.ext||{}).intweb;return n&&(0,u.Sn)(n.msfpc)?n.msfpc:null}function L(e){for(var n=null,t=0;null===n&&t<e.length;t++)n=H(e[t]);return n}var F=function(){function e(n,t){var i=t?[].concat(t):[],r=this,a=L(i);r.iKey=function(){return n},r.Msfpc=function(){return a||m},r.count=function(){return i.length},r.events=function(){return i},r.addEvent=function(e){return!!e&&(i.push(e),a||(a=H(e)),!0)},r.split=function(t,r){var o;if(t<i.length){var s=i.length-t;(0,c.le)(r)||(s=r<s?r:s),o=i.splice(t,s),a=L(i)}return new e(n,o)}}return e.create=function(n,t){return new e(n,t)},e}();const U=function(){function e(){var n=!0,t=!0,i=!0,a="use-collector-delta",o=!1;(0,r.Z)(e,this,(function(e){e.allowRequestSending=function(){return n},e.firstRequestSent=function(){i&&(i=!1,o||(n=!1))},e.shouldAddClockSkewHeaders=function(){return t},e.getClockSkewHeaderValue=function(){return a},e.setClockSkew=function(e){o||(e?(a=e,t=!0,o=!0):t=!1,n=!0)}}))}return e.__ieDyn=1,e}();const q=function(){function e(){var n={};(0,r.Z)(e,this,(function(e){e.setKillSwitchTenants=function(e,t){if(e&&t)try{var i=(o=e.split(","),s=[],o&&(0,c.tO)(o,(function(e){s.push((0,c.nd)(e))})),s);if("this-request-only"===t)return i;for(var r=1e3*parseInt(t,10),a=0;a<i.length;++a)n[i[a]]=(0,c.m6)()+r}catch(e){return[]}var o,s;return[]},e.isTenantKilled=function(e){var t=n,i=(0,c.nd)(e);return void 0!==t[i]&&t[i]>(0,c.m6)()||(delete t[i],!1)}}))}return e.__ieDyn=1,e}();var I=t(1550);function z(e){var n,t=Math.floor(1200*Math.random())+2400;return n=Math.pow(2,e)*t,Math.min(n,6e5)}var D,j=2e6,N=Math.min(j,65e3),J=/\./,X=function(){function e(n,t,i,o){var s="data",l="baseData",f=!!o,d=t,v={};(0,r.Z)(e,this,(function(e){function t(e,n,r,a,o,s,l){(0,c.rW)(e,(function(e,h){var p=null;if(h||(0,u.Sn)(h)){var y=r,m=e,g=o,b=n;if(f&&!a&&J.test(e)){var S=e.split("."),T=S.length;if(T>1){g&&(g=g.slice());for(var _=0;_<T-1;_++){var x=S[_];b=b[x]=b[x]||{},y+="."+x,g&&g.push(x)}m=S[T-1]}}var R=a&&function(e,n){var t=v[e];return void 0===t&&(e.length>=7&&(t=(0,c.xe)(e,"ext.metadata")||(0,c.xe)(e,"ext.web")),v[e]=t),t}(y);if(p=!R&&d&&d.handleField(y,m)?d.value(y,m,h,i):(0,u.yj)(m,h,i)){var E=p.value;if(b[m]=E,s&&s(g,m,p),l&&"object"==typeof E&&!(0,c.kJ)(E)){var k=g;k&&(k=k.slice()).push(m),t(h,E,y+"."+m,a,k,s,l)}}}}))}e.createPayload=function(e,n,t,i,r,a){return{apiKeys:[],payloadBlob:m,overflow:null,sizeExceed:[],failedEvts:[],batches:[],numEvents:0,retryCnt:e,isTeardown:n,isSync:t,isBeacon:i,sendType:a,sendReason:r}},e.appendPayload=function(t,i,r){var o=t&&i&&!t.overflow;return o&&(0,a.Lm)(n,(function(){return"Serializer:appendPayload"}),(function(){for(var n=i.events(),a=t.payloadBlob,o=t.numEvents,s=!1,u=[],l=[],f=t.isBeacon,d=f?65e3:3984588,v=f?N:j,h=0,p=0;h<n.length;){var y=n[h];if(y){if(o>=r){t.overflow=i.split(h);break}var m=e.getEventBlob(y);if(m&&m.length<=v){var g=m.length;if(a.length+g>d){t.overflow=i.split(h);break}a&&(a+="\n"),a+=m,++p>20&&(a.substr(0,1),p=0),s=!0,o++}else m?u.push(y):l.push(y),n.splice(h,1),h--}h++}if(u&&u.length>0&&t.sizeExceed.push(F.create(i.iKey(),u)),l&&l.length>0&&t.failedEvts.push(F.create(i.iKey(),l)),s){t.batches.push(i),t.payloadBlob=a,t.numEvents=o;var b=i.iKey();-1===(0,c.UA)(t.apiKeys,b)&&t.apiKeys.push(b)}}),(function(){return{payload:t,theBatch:{iKey:i.iKey(),evts:i.events()},max:r}})),o},e.getEventBlob=function(e){try{return(0,a.Lm)(n,(function(){return"Serializer.getEventBlob"}),(function(){var n={};n.name=e.name,n.time=e.time,n.ver=e.ver,n.iKey="o:"+(0,u.jM)(e.iKey);var i={},r=e.ext;r&&(n.ext=i,(0,c.rW)(r,(function(e,n){t(n,i[e]={},"ext."+e,!0,null,null,!0)})));var a=n.data={};a.baseType=e.baseType;var o=a.baseData={};return t(e.baseData,o,l,!1,[l],(function(e,n,t){Q(i,e,n,t)}),true),t(e.data,a,s,!1,[],(function(e,n,t){Q(i,e,n,t)}),true),JSON.stringify(n)}),(function(){return{item:e}}))}catch(e){return null}}}))}return e.__ieDyn=1,e}();function Q(e,n,t,i){if(i&&e){var r=(0,u.Vv)(i.value,i.kind,i.propertyType);if(r>-1){var a=e.metadata;a||(a=e.metadata={f:{}});var o=a.f;if(o||(o=a.f={}),n)for(var s=0;s<n.length;s++){var l=n[s];o[l]||(o[l]={f:{}});var f=o[l].f;f||(f=o[l].f={}),o=f}o=o[t]={},(0,c.kJ)(i.value)?o.a={t:r}:o.t=r}}}var W="&NoResponseBody=true",V=((D={})[1]=T,D[100]=T,D[200]="sent",D[8004]=b,D[8003]=b,D),Z={},Y={};function $(e,n,t){Z[e]=n,!1!==t&&(Y[n]=e)}function G(e){try{return e.responseText}catch(e){}return m}function ee(e,n){var t=!1;if(e&&n){var i=(0,c.FY)(e);if(i&&i.length>0)for(var r=n.toLowerCase(),a=0;a<i.length;a++){var o=i[a];if(o&&(0,c.nr)(n,o)&&o.toLowerCase()===r){t=!0;break}}}return t}function ne(e,n,t,i){n&&t&&t.length>0&&(i&&Z[n]?(e.hdrs[Z[n]]=t,e.useHdrs=!0):e.url+="&"+n+"="+t)}function te(e,n){return n&&((0,c.hj)(n)?e=[n].concat(e):(0,c.kJ)(n)&&(e=n.concat(e))),e}$(A,A,!1),$(K,K),$(O,"Client-Id"),$(M,M),$(P,P),$(C,C),$(B,B);var ie=function(){function e(n,t,i,o,s){this._responseHandlers=[];var f,v,h,p,y,T,A,B,H,L,F="?cors=true&"+E.toLowerCase()+"="+x,D=new q,j=!1,N=new U,J=!1,Q=0,Z=!0,$=[],ie={},re=[],ae=null,oe=!1,se=!1,ue=!1;(0,r.Z)(e,this,(function(e){var r=!0;function U(e,n){for(var t=0,i=null,r=0;null==i&&r<e.length;)1===(t=e[r])?(0,l.cp)()?i=q:(0,l.Z3)()&&(i=le):2===t&&(0,l.JO)(n)&&(!n||n&&!B)?i=ce:J&&3===t&&(0,l.MF)()&&(i=de),r++;return i?{_transport:t,_isSync:n,sendPOST:i}:null}function q(e,n,t){var i=new XDomainRequest;i.open(g,e.urlString),e.timeout&&(i.timeout=e.timeout),i.onload=function(){var e=G(i);fe(n,200,{},e),Re(e)},i.onerror=function(){fe(n,400,{})},i.ontimeout=function(){fe(n,500,{})},i.onprogress=function(){},t?i.send(e.data):s.set((function(){i.send(e.data)}),0)}function ce(e,n,t){var i,a=e.urlString,o=!1,u=!1,l=((i={body:e.data,method:g}).Microsoft_ApplicationInsights_BypassAjaxInstrumentation=!0,i);t&&(l.keepalive=!0,2===e._sendReason&&(o=!0,L&&(a+=W))),r&&(l.credentials="include"),e.headers&&(0,c.FY)(e.headers).length>0&&(l.headers=e.headers),fetch(a,l).then((function(e){var t={},i=m,r=e.headers;r&&r.forEach((function(e,n){t[n]=e})),e.body&&e.text().then((function(e){i=e})),u||(u=!0,fe(n,e.status,t,i),Re(i))})).catch((function(e){u||(u=!0,fe(n,0,{}))})),o&&!u&&(u=!0,fe(n,200,{})),!u&&e.timeout>0&&s.set((function(){u||(u=!0,fe(n,500,{}))}),e.timeout)}function le(e,n,t){var i=e.urlString;function a(e,n,t){if(!e[t]&&n&&n.getResponseHeader){var i=n.getResponseHeader(t);i&&(e[t]=(0,c.nd)(i))}return e}function o(e){var n={};return e.getAllResponseHeaders?n=function(e){var n={};if((0,c.HD)(e)){var t=(0,c.nd)(e).split(/[\r\n]+/);(0,c.tO)(t,(function(e){if(e){var t=e.indexOf(": ");if(-1!==t){var i=(0,c.nd)(e.substring(0,t)).toLowerCase(),r=(0,c.nd)(e.substring(t+1));n[i]=r}else n[(0,c.nd)(e)]=1}}))}return n}(e.getAllResponseHeaders()):(n=a(n,e,w),n=a(n,e,k),n=a(n,e,"kill-duration-seconds")),n}function s(e,t){fe(n,e.status,o(e),t)}t&&e.disableXhrSync&&(t=!1);var l=(0,u.ot)(g,i,r,!0,t,e.timeout);(0,c.rW)(e.headers,(function(e,n){l.setRequestHeader(e,n)})),l.onload=function(){var e=G(l);s(l,e),Re(e)},l.onerror=function(){s(l)},l.ontimeout=function(){s(l)},l.send(e.data)}function fe(e,n,t,i){try{e(n,t,i)}catch(e){(0,d.kP)(v,2,518,(0,l.eU)(e))}}function de(e,n,t){var i=200,r=e._thePayload,a=e.urlString+(L?W:m);try{var o=(0,l.jW)();if(!o.sendBeacon(a,e.data))if(r){var s=[];(0,c.tO)(r.batches,(function(e){if(s&&e&&e.count()>0){for(var n=e.events(),t=0;t<n.length;t++)if(!o.sendBeacon(a,ae.getEventBlob(n[t]))){s.push(e.split(t));break}}else s.push(e.split(0))})),Ee(s,8003,r.sendType,!0)}else i=0}catch(e){(0,d.jV)(v,"Failed to send telemetry using sendBeacon API. Ex:"+(0,l.eU)(e)),i=0}finally{fe(n,i,{},m)}}function ve(e){return 2===e||3===e}function he(e){return se&&ve(e)&&(e=2),e}function pe(){return!j&&Q<t}function ye(){var e=re;return re=[],e}function me(e,n,t){var i=!1;return e&&e.length>0&&!j&&h[n]&&ae&&(i=0!==n||pe()&&(t>0||N.allowRequestSending())),i}function ge(e){var n={};return e&&(0,c.tO)(e,(function(e,t){n[t]={iKey:e.iKey(),evts:e.events()}})),n}function be(e,t,i,r,o){if(e&&0!==e.length)if(j)Ee(e,1,r);else{r=he(r);try{var s=e,c=0!==r;(0,a.Lm)(p,(function(){return"HttpManager:_sendBatches"}),(function(a){a&&(e=e.slice(0));for(var s=[],l=null,f=(0,u.hK)(),d=h[r]||(c?h[1]:h[0]),v=d&&d._transport,p=H&&(se||ve(r)||3===v||d._isSync&&2===v);me(e,r,t);){var y=e.shift();y&&y.count()>0&&(D.isTenantKilled(y.iKey())?s.push(y):(l=l||ae.createPayload(t,i,c,p,o,r),ae.appendPayload(l,y,n)?null!==l.overflow&&(e=[l.overflow].concat(e),l.overflow=null,_e(l,f,(0,u.hK)(),o),f=(0,u.hK)(),l=null):(_e(l,f,(0,u.hK)(),o),f=(0,u.hK)(),e=[y].concat(e),l=null)))}l&&_e(l,f,(0,u.hK)(),o),e.length>0&&(re=e.concat(re)),Ee(s,8004,r)}),(function(){return{batches:ge(s),retryCount:t,isTeardown:i,isSynchronous:c,sendReason:o,useSendBeacon:ve(r),sendType:r}}),!c)}catch(e){(0,d.kP)(v,2,48,"Unexpected Exception sending batch: "+(0,l.eU)(e))}}}function Se(e,n){var t={url:F,hdrs:{},useHdrs:!1};n?(t.hdrs=(0,u.l7)(t.hdrs,ie),t.useHdrs=(0,c.FY)(t.hdrs).length>0):(0,c.rW)(ie,(function(e,n){Y[e]?ne(t,Y[e],n,!1):(t.hdrs[e]=n,t.useHdrs=!0)})),ne(t,O,"NO_AUTH",n),ne(t,K,u.vs,n);var i=m;(0,c.tO)(e.apiKeys,(function(e){i.length>0&&(i+=","),i+=e})),ne(t,M,i,n),ne(t,C,(0,c.m6)().toString(),n);var r=function(e){for(var n=0;n<e.batches.length;n++){var t=e.batches[n].Msfpc();if(t)return encodeURIComponent(t)}return m}(e);if((0,u.Sn)(r)&&(t.url+="&ext.intweb.msfpc="+r),N.shouldAddClockSkewHeaders()&&ne(t,P,N.getClockSkewHeaderValue(),n),p.getWParam){var a=p.getWParam();a>=0&&(t.url+="&w="+a)}for(var o=0;o<$.length;o++)t.url+="&"+$[o].name+"="+$[o].value;return t}function Te(e,n,t){e[n]=e[n]||{},e[n][f.identifier]=t}function _e(n,t,r,o){if(n&&n.payloadBlob&&n.payloadBlob.length>0){var s=!!e.sendHook,y=h[n.sendType];!ve(n.sendType)&&n.isBeacon&&2===n.sendReason&&(y=h[2]||h[3]||y);var m=ue;(n.isBeacon||3===y._transport)&&(m=!1);var g=Se(n,m);m=m||g.useHdrs;var b=(0,u.hK)();(0,a.Lm)(p,(function(){return"HttpManager:_doPayloadSend"}),(function(){for(var h=0;h<n.batches.length;h++)for(var S=n.batches[h].events(),_=0;_<S.length;_++){var k=S[_];if(oe){var w=k.timings=k.timings||{};Te(w,"sendEventStart",b),Te(w,"serializationStart",t),Te(w,"serializationCompleted",r)}k.sendAttempt>0?k.sendAttempt++:k.sendAttempt=1}Ee(n.batches,1e3+(o||0),n.sendType,!0);var K={data:n.payloadBlob,urlString:g.url,headers:g.hdrs,_thePayload:n,_sendReason:o,timeout:T,disableXhrSync:A,disableFetchKeepAlive:B};m&&(ee(K.headers,R)||(K.headers["cache-control"]="no-cache, no-store"),ee(K.headers,E)||(K.headers["content-type"]=x));var O=null;y&&(O=function(t){N.firstRequestSent();var r=function(t,r){!function(n,t,r,a){var o=9e3,s=null,l=!1,d=!1;try{var v=!0;if(typeof n!==I.jA){if(t){N.setClockSkew(t["time-delta-millis"]);var h=t["kill-duration"]||t["kill-duration-seconds"];(0,c.tO)(D.setKillSwitchTenants(t["kill-tokens"],h),(function(e){(0,c.tO)(r.batches,(function(n){if(n.iKey()===e){s=s||[];var t=n.split(0);r.numEvents-=t.count(),s.push(t)}}))}))}if(200==n||204==n)return void(o=200);((y=n)>=300&&y<500&&408!=y&&429!=y||501==y||505==y||r.numEvents<=0)&&(v=!1),o=9e3+n%1e3}if(v){o=100;var p=r.retryCnt;0===r.sendType&&(p<i?(l=!0,xe((function(){0===r.sendType&&Q--,be(r.batches,p+1,r.isTeardown,se?2:r.sendType,5)}),se,z(p))):(d=!0,se&&(o=8001)))}}finally{l||(N.setClockSkew(),function(n,t,i,r){try{r&&f._backOffTransmission(),200===t&&(r||n.isSync||f._clearBackOff(),function(e){if(oe){var n=(0,u.hK)();(0,c.tO)(e,(function(e){e&&e.count()>0&&function(e,n){oe&&(0,c.tO)(e,(function(e){Te(e.timings=e.timings||{},"sendEventCompleted",n)}))}(e.events(),n)}))}}(n.batches)),Ee(n.batches,t,n.sendType,!0)}finally{0===n.sendType&&(Q--,5!==i&&e.sendQueuedRequests(n.sendType,i))}}(r,o,a,d)),Ee(s,8004,r.sendType)}var y}(t,r,n,o)},a=n.isTeardown||n.isSync;try{y.sendPOST(t,r,a),e.sendListener&&e.sendListener(K,t,a,n.isBeacon)}catch(e){(0,d.jV)(v,"Unexpected exception sending payload. Ex:"+(0,l.eU)(e)),fe(r,0,{})}}),(0,a.Lm)(p,(function(){return"HttpManager:_doPayloadSend.sender"}),(function(){if(O)if(0===n.sendType&&Q++,s&&!n.isBeacon&&3!==y._transport){var t={data:K.data,urlString:K.urlString,headers:(0,u.l7)({},K.headers),timeout:K.timeout,disableXhrSync:K.disableXhrSync,disableFetchKeepAlive:K.disableFetchKeepAlive},i=!1;(0,a.Lm)(p,(function(){return"HttpManager:_doPayloadSend.sendHook"}),(function(){try{e.sendHook(t,(function(e){i=!0,Z||e._thePayload||(e._thePayload=e._thePayload||K._thePayload,e._sendReason=e._sendReason||K._sendReason),O(e)}),n.isSync||n.isTeardown)}catch(e){i||O(K)}}))}else O(K)}))}),(function(){return{thePayload:n,serializationStart:t,serializationCompleted:r,sendReason:o}}),n.isSync)}n.sizeExceed&&n.sizeExceed.length>0&&Ee(n.sizeExceed,8003,n.sendType),n.failedEvts&&n.failedEvts.length>0&&Ee(n.failedEvts,8002,n.sendType)}function xe(e,n,t){n?e():s.set(e,t)}function Re(n){var t=e._responseHandlers;try{for(var i=0;i<t.length;i++)try{t[i](n)}catch(e){(0,d.kP)(v,1,519,"Response handler failed: "+e)}if(n){var r=JSON.parse(n);(0,u.Sn)(r.webResult)&&(0,u.Sn)(r.webResult.msfpc)&&y.set("MSFPC",r.webResult.msfpc,31536e3)}}catch(e){}}function Ee(e,n,t,i){if(e&&e.length>0&&o){var r=o[function(e){var n=V[e];(0,u.Sn)(n)||(n="oth",e>=9e3&&e<=9999?n=_:e>=8e3&&e<=8999?n=b:e>=1e3&&e<=1999&&(n=S));return n}(n)];if(r){var s=0!==t;(0,a.Lm)(p,(function(){return"HttpManager:_sendBatchesNotification"}),(function(){xe((function(){try{r.call(o,e,n,s,t)}catch(e){(0,d.kP)(v,1,74,"send request notification failed: "+e)}}),i||s,0)}),(function(){return{batches:ge(e),reason:n,isSync:s,sendSync:i,sendType:t}}),!s)}}}e.initialize=function(e,n,t,i,a){var o;a||(a={}),F=e+F,ue=!!(0,c.o8)(a.avoidOptions)||!a.avoidOptions,p=n,y=n.getCookieMgr(),oe=!p.config.disableEventTimings;var s=!!p.config.enableCompoundKey;v=(f=t).diagLog();var u=a.valueSanitizer,m=a.stringifyObjects;(0,c.o8)(a.enableCompoundKey)||(s=!!a.enableCompoundKey),T=a.xhrTimeout,A=!!a.disableXhrSync,B=!!a.disableFetchKeepAlive,L=!1!==a.addNoResponse,J=!(0,l.b$)(),ae=new X(p,u,m,s),(0,c.le)(a.useSendBeacon)||(J=!!a.useSendBeacon);var g=i,b=a.alwaysUseXhrOverride?i:null,S=a.alwaysUseXhrOverride?i:null,_=[3,2];if(!i){Z=!1;var x=(0,l.k$)();x&&x.protocol&&"file:"===x.protocol.toLowerCase()&&(r=!1);var R=[];(0,l.b$)()?(R=[2,1],_=[2,1,3]):R=[1,2,3],(i=U(R=te(R,a.transports),!1))||(0,d.jV)(v,"No available transport to send events"),g=U(R,!0)}b||(b=U(_=te(_,a.unloadTransports),!0)),H=!Z&&(J&&(0,l.MF)()||!B&&(0,l.JO)(!0)),(o={})[0]=i,o[1]=g||U([1,2,3],!0),o[2]=b||g||U([1],!0),o[3]=S||U([2,3],!0)||g||U([1],!0),h=o},e._getDbgPlgTargets=function(){return[h[0],D,ae,h]},e.addQueryStringParameter=function(e,n){for(var t=0;t<$.length;t++)if($[t].name===e)return void($[t].value=n);$.push({name:e,value:n})},e.addHeader=function(e,n){ie[e]=n},e.canSendRequest=function(){return pe()&&N.allowRequestSending()},e.sendQueuedRequests=function(e,n){(0,c.o8)(e)&&(e=0),se&&(e=he(e),n=2),me(re,e,0)&&be(ye(),0,!1,e,n||0)},e.isCompletelyIdle=function(){return!j&&0===Q&&0===re.length},e.setUnloading=function(e){se=e},e.addBatch=function(e){if(e&&e.count()>0){if(D.isTenantKilled(e.iKey()))return!1;re.push(e)}return!0},e.teardown=function(){re.length>0&&be(ye(),0,!0,2,2)},e.pause=function(){j=!0},e.resume=function(){j=!1,e.sendQueuedRequests(0,4)},e.sendSynchronousBatch=function(e,n,t){e&&e.count()>0&&((0,c.le)(n)&&(n=1),se&&(n=he(n),t=2),be([e],0,!1,n,t||0))}}))}return e.__ieDyn=1,e}();function re(e,n){for(var t=[],i=2;i<arguments.length;i++)t[i-2]=arguments[i];return setTimeout(e,n,t)}function ae(e){clearTimeout(e)}function oe(e,n){return{set:e||re,clear:n||ae}}var se="eventsDiscarded";const ue=function(e){function n(){var t,i=e.call(this)||this;i.identifier="PostChannel",i.priority=1011,i.version="3.2.9";var v,m,g,b,S,T,_,x=!1,R=[],E=null,k=!1,w=0,K=500,O=0,P=1e4,C={},M=h,B=null,H=null,L=0,U=0,q={},I=-1,D=!0,j=!1,N=6,J=2;return(0,r.Z)(n,i,(function(e,n){function i(e){"beforeunload"!==(e||(0,l.Jj)().event).type&&(j=!0,m.setUnloading(j)),G(2,2)}function r(e){j=!1,m.setUnloading(j)}function X(e,n){if(e.sendAttempt||(e.sendAttempt=0),e.latency||(e.latency=1),e.ext&&e.ext.trace&&delete e.ext.trace,e.ext&&e.ext.user&&e.ext.user.id&&delete e.ext.user.id,D&&(u.if,e.ext=(0,c.Ax)(e.ext),e.baseData&&(e.baseData=(0,c.Ax)(e.baseData)),e.data&&(e.data=(0,c.Ax)(e.data))),e.sync)if(L||k)e.latency=3,e.sync=!1;else if(m)return D&&(e=(0,c.Ax)(e)),void m.sendSynchronousBatch(F.create(e.iKey,[e]),!0===e.sync?1:e.sync,3);var t=e.latency,i=O,r=P;4===t&&(i=w,r=K);var a=!1;if(i<r)a=!te(e,n);else{var o=1,s=20;4===t&&(o=4,s=1),a=!0,function(e,n,t,i){for(;t<=n;){var r=ee(e,n,!0);if(r&&r.count()>0){var a=r.split(0,i),o=a.count();if(o>0)return 4===t?w-=o:O-=o,he(se,[a],f.h.QueueFull),!0}t++}return re(),!1}(e.iKey,e.latency,o,s)&&(a=!te(e,n))}a&&ve(se,[e],f.h.QueueFull)}function Q(e,n,t){var i=ae(e,n,t);return m.sendQueuedRequests(n,t),i}function W(){return O>0}function V(){if(I>=0&&ae(I,0,S)&&m.sendQueuedRequests(0,S),w>0&&!H&&!k){var e=C[M][2];e>=0&&(H=Y((function(){H=null,Q(4,0,1),V()}),e))}var n=C[M][1];!B&&!E&&n>=0&&!k&&(W()?B=Y((function(){B=null,Q(0===U?3:1,0,1),U++,U%=2,V()}),n):U=0)}function Z(){t=null,x=!1,R=[],E=null,k=!1,w=0,K=500,O=0,P=1e4,C={},M=h,B=null,H=null,L=0,U=0,v=null,q={},g=void 0,b=0,I=-1,S=null,D=!0,j=!1,N=6,J=2,T=null,_=oe(),m=new ie(500,2,1,{requeue:fe,send:pe,sent:ye,drop:me,rspFail:ge,oth:be},_),le(),q[4]={batches:[],iKeyMap:{}},q[3]={batches:[],iKeyMap:{}},q[2]={batches:[],iKeyMap:{}},q[1]={batches:[],iKeyMap:{}},Se()}function Y(e,n){0===n&&L&&(n=1);var t=1e3;return L&&(t=z(L-1)),_.set(e,n*t)}function $(){return null!==B&&(_.clear(B),B=null,U=0,!0)}function G(e,n){$(),E&&(_.clear(E),E=null),k||Q(1,e,n)}function ee(e,n,t){var i=q[n];i||(i=q[n=1]);var r=i.iKeyMap[e];return!r&&t&&(r=F.create(e),i.batches.push(r),i.iKeyMap[e]=r),r}function ne(n,t){m.canSendRequest()&&!L&&(g>0&&O>g&&(t=!0),t&&null==E&&e.flush(n,null,20))}function te(e,n){D&&(e=(0,c.Ax)(e));var t=e.latency,i=ee(e.iKey,t,!0);return!!i.addEvent(e)&&(4!==t?(O++,n&&0===e.sendAttempt&&ne(!e.sync,b>0&&i.count()>=b)):w++,!0)}function re(){for(var e=0,n=0,t=function(t){var i=q[t];i&&i.batches&&(0,c.tO)(i.batches,(function(i){4===t?e+=i.count():n+=i.count()}))},i=1;i<=4;i++)t(i);O=n,w=e}function ae(n,t,i){var r=!1,o=0===t;return!o||m.canSendRequest()?(0,a.Lm)(e.core,(function(){return"PostChannel._queueBatches"}),(function(){for(var e=[],t=4;t>=n;){var i=q[t];i&&i.batches&&i.batches.length>0&&((0,c.tO)(i.batches,(function(n){m.addBatch(n)?r=r||n&&n.count()>0:e=e.concat(n.events()),4===t?w-=n.count():O-=n.count()})),i.batches=[],i.iKeyMap={}),t--}e.length>0&&ve(se,e,f.h.KillSwitch),r&&I>=n&&(I=-1,S=0)}),(function(){return{latency:n,sendType:t,sendReason:i}}),!o):(I=I>=0?Math.min(I,n):n,S=Math.max(S,i)),r}function ue(e,n){Q(1,0,n),re(),ce((function(){e&&e(),R.length>0?E=Y((function(){E=null,ue(R.shift(),n)}),0):(E=null,V())}))}function ce(e){m.isCompletelyIdle()?e():E=Y((function(){E=null,ce(e)}),.25)}function le(){(C={})[h]=[2,1,0],C[p]=[6,3,0],C[y]=[18,9,0]}function fe(n,t){var i=[],r=N;j&&(r=J),(0,c.tO)(n,(function(n){n&&n.count()>0&&(0,c.tO)(n.events(),(function(n){n&&(n.sync&&(n.latency=4,n.sync=!1),n.sendAttempt<r?((0,u.if)(n,e.identifier),X(n,!1)):i.push(n))}))})),i.length>0&&ve(se,i,f.h.NonRetryableStatus),j&&G(2,2)}function de(n,t){var i=e._notificationManager||{},r=i[n];if(r)try{r.apply(i,t)}catch(t){(0,d.kP)(e.diagLog(),1,74,n+" notification failed: "+t)}}function ve(e,n){for(var t=[],i=2;i<arguments.length;i++)t[i-2]=arguments[i];n&&n.length>0&&de(e,[n].concat(t))}function he(e,n){for(var t=[],i=2;i<arguments.length;i++)t[i-2]=arguments[i];n&&n.length>0&&(0,c.tO)(n,(function(n){n&&n.count()>0&&de(e,[n.events()].concat(t))}))}function pe(e,n,t){e&&e.length>0&&de("eventsSendRequest",[n>=1e3&&n<=1999?n-1e3:0,!0!==t])}function ye(e,n){he("eventsSent",e,n),V()}function me(e,n){he(se,e,n>=8e3&&n<=8999?n-8e3:f.h.Unknown)}function ge(e){he(se,e,f.h.NonRetryableStatus),V()}function be(e,n){he(se,e,f.h.Unknown),V()}function Se(){b=t&&t.disableAutoBatchFlushLimit?0:Math.max(1500,P/6)}Z(),e._getDbgPlgTargets=function(){return[m]},e.initialize=function(l,f,d){(0,a.Lm)(f,(function(){return"PostChannel:initialize"}),(function(){var a=f;n.initialize(l,f,d);try{f.addUnloadCb;T=(0,o.jU)((0,s.J)(e.identifier),f.evtNamespace&&f.evtNamespace());var h=e._getTelCtx();l.extensionConfig[e.identifier]=l.extensionConfig[e.identifier]||{},t=h.getExtCfg(e.identifier),_=oe(t.setTimeoutOverride,t.clearTimeoutOverride),D=!t.disableOptimizeObj&&(0,u.mJ)(),function(e){var n=e.getWParam;e.getWParam=function(){var e=0;return t.ignoreMc1Ms0CookieProcessing&&(e|=2),e|n()}}(a),t.eventsLimitInMem>0&&(P=t.eventsLimitInMem),t.immediateEventLimit>0&&(K=t.immediateEventLimit),t.autoFlushEventsLimit>0&&(g=t.autoFlushEventsLimit),(0,c.hj)(t.maxEventRetryAttempts)&&(N=t.maxEventRetryAttempts),(0,c.hj)(t.maxUnloadEventRetryAttempts)&&(J=t.maxUnloadEventRetryAttempts),Se(),t.httpXHROverride&&t.httpXHROverride.sendPOST&&(v=t.httpXHROverride),(0,u.Sn)(l.anonCookieName)&&m.addQueryStringParameter("anoncknm",l.anonCookieName),m.sendHook=t.payloadPreprocessor,m.sendListener=t.payloadListener;var p=t.overrideEndpointUrl?t.overrideEndpointUrl:l.endpointUrl;e._notificationManager=f.getNotifyMgr(),m.initialize(p,e.core,e,v,t);var y=l.disablePageUnloadEvents||[];(0,o.c9)(i,y,T),(0,o.TJ)(i,y,T),(0,o.nD)(r,l.disablePageShowEvents,T)}catch(n){throw e.setInitialized(!1),n}}),(function(){return{coreConfig:l,core:f,extensions:d}}))},e.processTelemetry=function(n,i){(0,u.if)(n,e.identifier);var r=(i=e._getTelCtx(i)).getExtCfg(e.identifier),a=!!t.disableTelemetry;r&&(a=a||!!r.disableTelemetry);var o=n;a||x||(t.overrideInstrumentationKey&&(o.iKey=t.overrideInstrumentationKey),r&&r.overrideInstrumentationKey&&(o.iKey=r.overrideInstrumentationKey),X(o,!0),j?G(2,2):V()),e.processNext(o,i)},e._doTeardown=function(e,n){G(2,2),x=!0,m.teardown(),(0,o.JA)(null,T),(0,o.C9)(null,T),(0,o.Yl)(null,T),Z()},e.setEventQueueLimits=function(e,n){P=e>0?e:1e4,g=n>0?n:0,Se();var t=O>e;if(!t&&b>0)for(var i=1;!t&&i<=3;i++){var r=q[i];r&&r.batches&&(0,c.tO)(r.batches,(function(e){e&&e.count()>=b&&(t=!0)}))}ne(!0,t)},e.pause=function(){$(),k=!0,m.pause()},e.resume=function(){k=!1,m.resume(),V()},e.addResponseHandler=function(e){m._responseHandlers.push(e)},e._loadTransmitProfiles=function(e){$(),le(),M=h,V(),(0,c.rW)(e,(function(e,n){var t=n.length;if(t>=2){var i=t>2?n[2]:0;if(n.splice(0,t-2),n[1]<0&&(n[0]=-1),n[1]>0&&n[0]>0){var r=n[0]/n[1];n[0]=Math.ceil(r)*n[1]}i>=0&&n[1]>=0&&i>n[1]&&(i=n[1]),n.push(i),C[e]=n}}))},e.flush=function(e,n,t){if(void 0===e&&(e=!0),!k)if(t=t||1,e)null==E?($(),ae(1,0,t),E=Y((function(){E=null,ue(n,t)}),0)):R.push(n);else{var i=$();Q(1,1,t),null!=n&&n(),i&&V()}},e.setMsaAuthTicket=function(e){m.addHeader(A,e)},e.hasEvents=W,e._setTransmitProfile=function(e){M!==e&&void 0!==C[e]&&($(),M=e,V())},e._backOffTransmission=function(){L<4&&(L++,$(),V())},e._clearBackOff=function(){L&&(L=0,$(),V())},(0,c.l_)(e,"_setTimeoutOverride",(function(){return _.set}),(function(e){_=oe(e,_.clear)})),(0,c.l_)(e,"_clearTimeoutOverride",(function(){return _.clear}),(function(e){_=oe(_.set,e)}))})),i}return(0,i.ne)(n,e),n.__ieDyn=1,n}(v.i)}};
//# sourceMappingURL=488.extension.js.map